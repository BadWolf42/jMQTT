<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<title>jMQTT</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>jMQTT</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_présentation">1. Présentation</a></li>
<li><a href="#_configuration_du_plugin">2. Configuration du plugin</a></li>
<li><a href="#_gestion_des_équipements">3. Gestion des équipements</a>
<ul class="sectlevel2">
<li><a href="#_inclusion_automatique_des_équipements">3.1. Inclusion automatique des équipements</a></li>
<li><a href="#_paramètres_de_l_équipement">3.2. Paramètres de l&#8217;équipement</a>
<ul class="sectlevel3">
<li><a href="#_onglet_equipement">3.2.1. Onglet Equipement</a></li>
<li><a href="#_onglet_commandes">3.2.2. Onglet Commandes</a>
<ul class="sectlevel4">
<li><a href="#_commandes_de_type_information">Commandes de type Information</a></li>
<li><a href="#_commandes_de_type_action">Commandes de type Action</a></li>
<li><a href="#_vue_classic_vue_json">Vue Classic, vue JSON</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_création_manuelle_d_un_équipement">3.3. Création manuelle d'un équipement</a></li>
<li><a href="#_dupliquer_un_équipement">3.4. Dupliquer un équipement</a></li>
<li><a href="#_santé_du_plugin">3.5. Santé du plugin</a></li>
<li><a href="#_l_équipement_jeedom">3.6. L&#8217;équipement jeedom</a></li>
</ul>
</li>
<li><a href="#_api">4. API</a></li>
<li><a href="#_faq">5. FAQ</a></li>
<li><a href="#_problèmes_connus">6. Problèmes connus</a></li>
<li><a href="#_change_log">7. Change log</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_présentation">1. Présentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ce plugin permet de connecter Jeedom à un broker MQTT comme Mosquitto afin de récupérer les messages souscrits et de publier ses propres messages.</p>
</div>
<div class="paragraph">
<p>MQTT est un protocole de communication sur IP, basé sur une architecture client/serveur et un mécanisme de souscription/publication. Il est léger, ouvert, simple, caractéristiques qui ont favorisées sa démocratiation dans la communication Machine to Machine (M2M) et l&#8217;internet des objets (IoT - Internet of Things).</p>
</div>
<div class="paragraph">
<p>Pour tout savoir sur MQTT, la série d&#8217;article <a href="https://www.hivemq.com/mqtt-essentials/">MQTT Essentials</a> est à recommander.</p>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_du_plugin">2. Configuration du plugin</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Pour ne pas installer le broker Mosquitto localement, c&#8217;est à dire sur la machine où tourne Jeedom, commencer par décocher la case <em>Installer Mosquitto localement</em>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Après installation du plugin, l&#8217;activer. Celui-ci prend quelques minutes pour installer les dépendances. Le suivi détaillé de la progression est possible via le log <code><em>jMQTT_dep</em></code> qui apparait au bout d&#8217;un moment en rafraichissant la page.</p>
</div>
<div class="paragraph">
<p>Par défaut le plugin est configuré pour s&#8217;inscrire au broker Mosquitto installé localement. Si cette configuration convient, cliquer sur Sauvegarder. Le status du démon passe à OK. Rafraichir la page pour faire apparaitre le fichier de log <code><em>jMQTT</em></code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Configurer le niveau de log minimum à Info pour que le fichier de log apparaisse la première fois et avoir des informations intéressantes. Sauvegarder et relancer le démon pour rendre le changement actif.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Il peut arriver que l&#8217;installation du plugin se bloque. Cela se produit si le serveur apache est relancé pendant l&#8217;installation (voir log <code><em>jMQTT_dep</em></code>). Pour se débloquer, se connecter à sa station Jeedom et supprimer le fichier <code>/tmp/jeedom/jMQTT/progress_dep.txt</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Pour particulariser la configuration du plugin, les paramètres sont:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Installer Mosquitto localement: cocher cette case pour que jMQTT se charge de l&#8217;installation locale du broker Mosquitto. Si votre broker est distant, décocher la case.</p>
</li>
<li>
<p>IP de Mosquitto: adresse IP du broker (par défaut localhost i.e. sur la machine hébergeant Jeedom).</p>
</li>
<li>
<p>Port de Mosquitto: port du broker (1883 par défaut).</p>
</li>
<li>
<p>Identifiant de connexion: identifiant avec lequel le plugin s&#8217;inscrit auprès du broker (jeedom par défaut).</p>
</li>
<li>
<p>Compte et mot de passe de connexion: il est possible d&#8217;ajouter un compte et mot de passe si la connexion le nécessite (pas d&#8217;authentification par défaut).</p>
</li>
<li>
<p>Topic de souscription en mode inclusion automatique des équipments: topic de souscription automatique à partir duquel le plugin va découvrir les équipements de manière automatique, nous y revenons dans la partie équipements (défaut #, i.e. tous les topics).</p>
</li>
<li>
<p>Accès API: à activer pour utiliser l'<a href="#_api">API</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>La sauvegarde de la configuration relance le démon et la souscription au broker MQTT avec les nouveaux paramètres.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Il est conseillé d&#8217;activer la gestion automatique du démon. Ainsi, en cas de problème (e.g. perte de connexion au broker), Jeedom relancera le démon toutes les 5 minutes, aux minutes fixes 00, 05, 10, &#8230;&#8203;
</td>
</tr>
</table>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_gestion_des_équipements">3. Gestion des équipements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>La page de gestion des équipements est accessible via le menu <code>Plugins &#8594; Protocole domotique &#8594; jMQTT</code>.</p>
</div>
<div class="paragraph">
<p>Le panneau supérieur, intitulé <em>Gestion</em>, permet:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>La <a href="#_création_manuelle_d_un_équipement">Création manuelle d'un équipement</a>;</p>
</li>
<li>
<p>L&#8217;activation du mode <a href="#_inclusion_automatique_des_équipements">Inclusion automatique des équipements</a>;</p>
</li>
<li>
<p>L&#8217;accès à la <a href="#_configuration_du_plugin">Configuration du plugin</a>;</p>
</li>
<li>
<p>L&#8217;accès à la page <a href="#_santé_du_plugin">Santé du plugin</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Le panneau inférieur, <em>Mes jMQTT</em> affiche les équipements présents. A noter que:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Un équipement grisé est inactif;</p>
</li>
<li>
<p>Un équipement cerclé d&#8217;une bordure bleue-mauve, ou grise si inactif, est un équipement dont l'<em>Ajout automatique des commandes</em> est activé.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_inclusion_automatique_des_équipements">3.1. Inclusion automatique des équipements</h3>
<div class="paragraph">
<p>Le mode inclusion automatique permet la découverte et la création automatique des équipements. Il s&#8217;active en cliquant sur le bouton <em>Mode inclusion</em>. Il se désactive en recliquant sur le même bouton, ou automatiquement après 2 à 3 min.</p>
</div>
<div class="paragraph">
<p>Le plugin souscrit auprès du broker le topic configuré dans la page de <a href="#_configuration_du_plugin">Configuration du plugin</a> (# par défaut, i.e. tous les topics). A réception d&#8217;un message dont le topic de premier niveau est nouveau, le plugin crée automatiquement un équipement associé à ce topic de premier niveau.</p>
</div>
<div class="paragraph">
<p>Prenons comme exemple une payload MQTT publiant les messages suivants:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>boiler/brand "viesmann"
boiler/burner 0
boiler/temp 70.0</pre>
</div>
</div>
<div class="paragraph">
<p>A l&#8217;arrivée du premier message, le plugin crée automatiquement un équipement nommé <em>boiler</em>. Nous verrons dans la section <a href="#_onglet_commandes">Onglet Commandes</a> que, par défaut, il créé aussi les informations associées à chaque message.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Le mode inclusion automatique des équipements n&#8217;influe que sur la création de l&#8217;équipement, et pas sur la création des informations associées, qui dépend du paramètre <em>Ajout automatique des commandes</em> que nous verrons dans le chapitre suivant.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Une fois les équipements découverts, il est conseillé de quitter le mode automatique pour éviter la création d&#8217;équipements non souhaités, notamment dans les situations suivantes : publication de messages (si jMQTT reste souscrit à tous les topics, il écoutera ses propres publications), essais avec le broker, tests de nouveaux équipements, &#8230;&#8203;
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_paramètres_de_l_équipement">3.2. Paramètres de l&#8217;équipement</h3>
<div class="sect3">
<h4 id="_onglet_equipement">3.2.1. Onglet Equipement</h4>
<div class="paragraph">
<p>Dans le premier onglet d&#8217;un équipement jMQTT, nous trouvons les paramètres communs aux autres équipements Jeedom, ainsi que quatre paramètres spécifiques au plugin:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inscrit au Topic: topic de souscription auprès du broker;</p>
</li>
<li>
<p>Ajout automatique des commandes: si coché, les commandes de type information seront automatiquement créés par le plugin, et l&#8217;équipement apparaitra cerclé d&#8217;une bordure dans la page de <a href="#_gestion_des_équipements">Gestion des équipements</a>. La case est cochée par défaut;</p>
</li>
<li>
<p>Qos: qualité de service souscrit;</p>
</li>
<li>
<p>Catégorie du topic: sélection d&#8217;une image spécifique à l&#8217;équipement.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Parmis le boutons en haut à gauche:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Export</code> permet d&#8217;obtenir un fichier JSON de toutes les informations de l&#8217;équipement. Il n&#8217;y a pas de fonctionalité import, le fichier peut surtout s&#8217;avérer utile pour investiguer sur problèmes;</p>
</li>
<li>
<p><code>Dupliquer</code> permet de <a href="#_dupliquer_un_équipement">Dupliquer un équipement</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Une fois les commandes créés, il est conseillé de décocher la case <em>Ajout automatique des commandes</em> pour éviter la création d&#8217;informations non souhaitées.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_onglet_commandes">3.2.2. Onglet Commandes</h4>
<div class="sect4">
<h5 id="_commandes_de_type_information">Commandes de type Information</h5>
<div class="paragraph">
<div class="title">Payload simple</div>
<p>Les commandes de type information (informations dans la suite) sont créés automatiquement si la case <em>Ajout automatique des commandes</em> de l&#8217;Onglet Equipement est cochée. Reprenons l&#8217;exemple de la payload MQTT publiant les messages suivants:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>boiler/brand "viesmann"
boiler/burner 0
boiler/temp 70.0
boiler/ext_temp 19.3
boiler/hw/setpoint 50
boiler/hw/temp 49.0</pre>
</div>
</div>
<div class="paragraph">
<p>Le plugin créé les informations suivantes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Nom</th>
<th class="tableblock halign-left valign-top">Sous-Type</th>
<th class="tableblock halign-left valign-top">Topic</th>
<th class="tableblock halign-left valign-top">Valeur</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boiler/brand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boiler/brand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">viesmann</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boiler/burner</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boiler/burner</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boiler/temp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boiler/temp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">70.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boiler/ext_temp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boiler/ext_temp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">19.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boiler/hw/setpoint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boiler/hw/setpoint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boiler/hw/temp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boiler/hw/temp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">49.0</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Payload JSON</div>
<p>Dans le cas d&#8217;une payload JSON, le plugin peut décoder le contenu et créer les informations associées, et ceci indépendamment de l&#8217;état de la case <em>Ajout automatique des commandes</em> de l&#8217;Onglet Equipement. Cette fonctionnalité doit être activée manuellement pour chaque commande information de ce type.</p>
</div>
<div class="paragraph">
<p>Prenons l&#8217;exemple de la payload JSON suivante:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>esp/temperatures {"device": "ESP32", "sensorType": "Temperature", "values": [9.5, 18.2, 20.6]}</pre>
</div>
</div>
<div class="paragraph">
<p>Au premier message reçu, jMQTT créé automatiquement l&#8217;information suivante:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Nom</th>
<th class="tableblock halign-left valign-top">Sous-Type</th>
<th class="tableblock halign-left valign-top">Topic</th>
<th class="tableblock halign-left valign-top">Valeur</th>
<th class="tableblock halign-left valign-top">Paramètres</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"device": "ESP32", "sensorType": "Temperature", "values": [9.5, 18.2, 20.6]}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[ ]</code> parseJSON</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>En cochant l&#8217;option <em>parseJSON</em>, les informations complémentaires sont instantanément créés, ce qui donne:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Nom</th>
<th class="tableblock halign-left valign-top">Sous-Type</th>
<th class="tableblock halign-left valign-top">Topic</th>
<th class="tableblock halign-left valign-top">Valeur</th>
<th class="tableblock halign-left valign-top">Paramètres</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"device": "ESP32", "sensorType": "Temperature", "values": [9.5, 18.2, 20.6]}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[X]</code> parseJSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">temperatures{device}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures{device}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"ESP32"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[ ]</code> parseJSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">temperatures{sensorType}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures{sensorType}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Temperature"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[ ]</code> parseJSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">temperatures{values}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures{values}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[9.5, 18.2, 20.6]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[ ]</code> parseJSON</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enfin, le vecteur des températures peut également être séparé en cochant la case  <em>parseJSON</em>, pour finalement obtenir:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Nom</th>
<th class="tableblock halign-left valign-top">Sous-Type</th>
<th class="tableblock halign-left valign-top">Topic</th>
<th class="tableblock halign-left valign-top">Valeur</th>
<th class="tableblock halign-left valign-top">Paramètres</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"device": "ESP32", "sensorType": "Temperature", "values": [9.5, 18.2, 20.6]}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[X]</code> parseJSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">temperatures{device}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures{device}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"ESP32"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[ ]</code> parseJSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">temperatures{sensorType}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures{sensorType}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Temperature"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[ ]</code> parseJSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">temperatures{values}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures{values}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[9.5, 18.2, 20.6]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[X]</code> parseJSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">temperatures{values}{0}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures{values}{0}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[ ]</code> parseJSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">temperatures{values}{1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures{values}{1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[ ]</code> parseJSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">temperatures{values}{2}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">esp/temperatures{values}{2}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[ ]</code> parseJSON</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Le nom des commandes peut être modifié comme souhaité, jMQTT se base sur le champ Topic pour associer la bonne valeur.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_commandes_de_type_action">Commandes de type Action</h5>
<div class="paragraph">
<p>Les commandes de type action permettent au plugin jMQTT de publier sur le broker MQTT. Pour cela, créer une commande via le bouton <em>+ Ajouter une commande action</em> et remplir les champs selon le besoin:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Nom: champ libre;</p>
</li>
<li>
<p>Valeur par défaut de la commande: pour lier la valeur de la commande affichée sur le dashboard à une commande de type Information (exemple <a href="https://www.jeedom.com/forum/viewtopic.php?f=96&amp;t=32675&amp;p=612364#p602740">ici</a>);</p>
</li>
<li>
<p>Sous-type: voir exemples ci-dessous;</p>
</li>
<li>
<p>Topic: topic de publication;</p>
</li>
<li>
<p>Valeur: définit la valeur publiée, i.e. la payload en langage MQTT, voir exemples ci-dessous;</p>
</li>
<li>
<p>Retain: si coché, la valeur sera persistante (conservée par le broker et publiée vers tout nouveau souscripteur);</p>
</li>
<li>
<p>Qos: niveau de qualité de service utilisé pour publier la commande (1 par défaut).</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Sous-type Défaut</div>
<p>Les exemples du tableau suivant:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Nom</th>
<th class="tableblock halign-left valign-top">Sous-Type</th>
<th class="tableblock halign-left valign-top">Topic</th>
<th class="tableblock halign-left valign-top">Valeur</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">set_hw_setpoint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action - Défaut</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hw/setpoint/set</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>40</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">set_hw_setpoint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action - Défaut</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hw/set</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"name": "setpoint", "value": 40}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">set_hw_setpoint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action - Défaut</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hw/set</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"name": "setpoint", "value": #[home][boiler][hw_setpoint]#}</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Publieront respectivement:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>hw/setpoint/set 40
hw/set {"name": "setpoint", "value": 40}
hw/set {"name": "setpoint", "value": 45}</pre>
</div>
</div>
<div class="paragraph">
<p>En supposant que <code>#[home][boiler][hw_setpoint]#</code> a pour valeur 45.</p>
</div>
<div class="paragraph">
<div class="title">Sous-type Curseur</div>
<p>Les configurations suivantes publieront la valeur saisie via un widget de type curseur:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Nom</th>
<th class="tableblock halign-left valign-top">Sous-Type</th>
<th class="tableblock halign-left valign-top">Topic</th>
<th class="tableblock halign-left valign-top">Valeur</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">set_hw_setpoint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action - Curseur</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hw/setpoint/set</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#slider#</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">set_hw_setpoint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action - Curseur</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hw/set</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"name": "setpoint", "value": #slider#}</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Soit respectivement, en supposant que la valeur du curseur est 50:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>hw/setpoint/set 50
hw/set {"name": "setpoint", "value": 50}</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Sous-type Message</div>
<p>Pour un message dont le titre est <code>ecs</code> et le contenu est <code>50</code>, la configuration ci-après publiera:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>boiler {"setpoint": "ecs", "value": 50}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Nom</th>
<th class="tableblock halign-left valign-top">Sous-Type</th>
<th class="tableblock halign-left valign-top">Topic</th>
<th class="tableblock halign-left valign-top">Valeur</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">set_ecs_setpoint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action - Message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boiler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"setpoint": "#title#", "value": #message#}</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Sous-type Couleur</div>
<p>La configuration suivante publiera le code couleur sélectionnée via un widget sélecteur de couleur, par exemple:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>room/lamp/color #e63939</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Nom</th>
<th class="tableblock halign-left valign-top">Sous-Type</th>
<th class="tableblock halign-left valign-top">Topic</th>
<th class="tableblock halign-left valign-top">Valeur</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">set_color</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">action - Couleur</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>room/lamp/color</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#color#</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_vue_classic_vue_json">Vue Classic, vue JSON</h5>
<div class="paragraph">
<p>Deux boutons en haut à droite de la page permettent de choisir entre 2 types du vue:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>La vue <strong>Classic</strong> montre les commandes dans l&#8217;ordre d&#8217;affichage sur la tuile du Dashboard. Elle permet de les réordonner par glissé/déposé;</p>
</li>
<li>
<p>La vue <strong>JSON</strong> affiche un arbre hiérarchique permettant de naviguer dans les commandes JSON, de les déplier/replier. Dans cette vue, l&#8217;ordonnancement des commandes via glissé/déposé est désactivée.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_création_manuelle_d_un_équipement">3.3. Création manuelle d'un équipement</h3>
<div class="paragraph">
<p>Il est aussi possible de créer manuellement des équipements jMQTT. Cliquer sur le bouton <strong>+</strong> et saisir le nom de l&#8217;équipement. Dans la page <a href="#_onglet_equipement">Onglet Equipement</a>, le topic de souscription définit les informations qui seront souscrites par l&#8217;équipement.</p>
</div>
<div class="paragraph">
<p>Pour plus d&#8217;information sur les topics MQTT, nous conseillons la lecture de <a href="https://www.hivemq.com/blog/mqtt-essentials-part-5-mqtt-topics-best-practices">MQTT Essentials Part 5: MQTT Topics &amp; Best Practices</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_dupliquer_un_équipement">3.4. Dupliquer un équipement</h3>
<div class="paragraph">
<p>Un équipement peut être dupliqué via le bouton <code>Dupliquer</code> situé en haut à gauche de la page de configuration de l&#8217;équipement.</p>
</div>
<div class="paragraph">
<p>Une boite de dialogue demande le nom du nouvel équipement. Sont dupliqués:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tous les paramètres de l&#8217;équipement y compris les paramètres de configuration avancés, sauf:</p>
<div class="ulist">
<ul>
<li>
<p>Le nom bien sûr,</p>
</li>
<li>
<p>Le statut <em>Activer</em> : l&#8217;équipement est désactivé par défaut,</p>
</li>
<li>
<p>Le topic de souscription qui est laissé vide;</p>
</li>
</ul>
</div>
</li>
<li>
<p>Les commandes de type action y compris leurs paramètres de configuration accessibles via la roue crantée.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Le topic des commandes dupliquées de type action doit être modifié manuellement.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Les commandes de type info ne sont pas dupliquées. Elles seront découvertes automatiquement après définition du topic de souscription et activation de l&#8217;équipement, si la case <em>Ajout automatique des commandes</em> est cochée.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_santé_du_plugin">3.5. Santé du plugin</h3>
<div class="paragraph">
<p>Ce chapitre est à écrire.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
La colonne <em>Status</em> n&#8217;est pas significative, elle indique toujours OK. Sera corrigé dans une version ultérieure du plugin.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_l_équipement_jeedom">3.6. L&#8217;équipement jeedom</h3>
<div class="paragraph">
<p>Le plugin jMQTT publie en mode persistant son état de connexion sous le topic <code><em>Identifiant de connexion</em>/status</code>, <code>jeedom/status</code> par défaut, puisque l&#8217;identifiant de connexion vaut jeedom par défaut et se configure via la page de <a href="#_configuration_du_plugin">Configuration du plugin</a>.</p>
</div>
<div class="paragraph">
<p>Les valeurs possibles sont <code>offline</code> et <code>online</code>.</p>
</div>
<div class="paragraph">
<p>Lorsque Jeedom est en mode <a href="#_inclusion_automatique_des_équipements">Inclusion automatique des équipements</a>, il créé un équipement, dont le nom est <code><em>Identifiant de connexion</em></code> qui a ce statut en information.</p>
</div>
<div class="paragraph">
<p>Cet état permet à un équipement externe à Jeedom de connaitre son statut de connexion. Il peut aussi servir en interne Jeedom pour monitorer la connexion au broker via un scénario.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_api">4. API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Le plugin permet d&#8217;accéder à toutes les méthodes de l&#8217;<a href="http://jeedom.github.io/core/fr_FR/jsonrpc_api">API JSON RPC</a> au travers du protocole MQTT.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Pour activer l&#8217;API:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Activer l&#8217;accès à l&#8217;API jMQTT dans la page de <a href="#_configuration_du_plugin">Configuration du plugin</a>;</p>
</li>
<li>
<p>Activer l'<strong>API JSON RPC</strong> dans la configuration Jeedom.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Les payloads requêtes doivent être adressées au topic <code><em>Identifiant de connexion</em>/api</code>, <code>jeedom/api</code> par défaut, l&#8217;identifiant de connexion étant jeedom par défaut et se configurant via la page de <a href="#_configuration_du_plugin">Configuration du plugin</a>.</p>
</div>
<div class="paragraph">
<p>Leur format JSON est:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{"method": "Méthode de la requête", "id": "Id. de la requête", "params": { Paramètres additionels }, "topic": "Topic de retour"}</pre>
</div>
</div>
<div class="paragraph">
<p>Où:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Méthode de la requête</code> : nom de la méthode invoquée, voir <a href="http://jeedom.github.io/core/fr_FR/jsonrpc_api">API JSON RPC</a>;</p>
</li>
<li>
<p><code>Id. de la requête</code> (optionnel) : identifiant qui sera retourné dans la réponse, doit être une chaine. Si absent, l&#8217;id de retour sera null;</p>
</li>
<li>
<p><code>Paramètres additionels</code> (optionnel) : paramètres relatifs à la méthode de la requête, voir <a href="http://jeedom.github.io/core/fr_FR/jsonrpc_api">API JSON RPC</a>;</p>
</li>
<li>
<p><code>Topic de retour</code> (optionnel) : topic sous lequel le plugin jMQTT publie la réponse à la requête. Si absent, la réponse n&#8217;est pas publiée.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Exemple:</div>
<p>Le tableau suivant fournit quelques exemples:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Requête</th>
<th class="tableblock halign-left valign-top">Réponse</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"method":"ping","topic":"retour"}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"jsonrpc":"2.0","id":null,"result":"pong"}</code> sur le topic <code>retour</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Teste la communication avec Jeedom</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"method":"ping","id":"3","topic":"retour"}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"jsonrpc":"2.0","id":"3","result":"pong"}</code> sur le topic <code>retour</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Teste la communication avec Jeedom</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"method":"cmd::execCmd","topic":"emetteur/retour", "id":"a","params":{"id":"798","options":{"slider":"40"}}}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"jsonrpc":"2.0", "id":"a", "result":{"value":"40","collectDate":""}}</code> sur le topic <code>emetteur/retour</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exécute la commande 798: positionne le curseur à 40</p></td>
</tr>
</tbody>
</table>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_faq">5. FAQ</h2>
<div class="sectionbody">
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_problèmes_connus">6. Problèmes connus</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les problèmes connus en cours d&#8217;investigation sont sur GitHub: <a href="https://github.com/domotruc/jMQTT/issues">Issues jMQTT</a>.</p>
</div>
<div class="paragraph">
<p>Il peut arriver que l&#8217;installation des dépendances se bloque, se référer au chapitre <a href="#_configuration_du_plugin">Configuration du plugin</a>.</p>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_change_log">7. Change log</h2>
<div class="sectionbody">
<div class="ulist">
<div class="title">2018-06-12</div>
<ul>
<li>
<p>Intégration des évolutions des 3 versions betas précédentes</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-06-11 (beta)</div>
<ul>
<li>
<p>Correction bugs mineurs relatif à <a href="https://github.com/domotruc/jMQTT/issues/53">#53</a>:</p>
<div class="ulist">
<ul>
<li>
<p>Lorsque le topic de retour n&#8217;est pas défini &#8658; affiche une erreur;</p>
</li>
<li>
<p>Lorsque l&#8217;encodage JSON de la requête est incorrect &#8658; affiche un message d&#8217;erreur plus clair.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-06-10 (beta)</div>
<ul>
<li>
<p>Complément à l&#8217;amélioration <a href="https://github.com/domotruc/jMQTT/issues/53">#53</a>:</p>
<div class="ulist">
<ul>
<li>
<p>Ajoute un paramètre pour activer/désactiver l&#8217;API dans la configuration plugin;</p>
</li>
<li>
<p>topic jeedom/jeeAPI changé en jeedom/api;</p>
</li>
<li>
<p>Mise à jour doc.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-06-07 (beta)</div>
<ul>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/53">#53</a>: api MQTT</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-06-03</div>
<ul>
<li>
<p>Intégration des évolutions des 3 versions betas précédentes</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-06-03 (beta)</div>
<ul>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/55">#55</a>: ajout d&#8217;une vue de visualisation hiérarchique JSON dans le panneau des commandes</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-05-26 (beta)</div>
<ul>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/45">#45</a>: décodage immédiat des payloads JSON sur activation de parseJSON</p>
</li>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/52">#52</a>: activer l&#8217;export d&#8217;un équipement dans un fichier json</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-05-24 (beta)</div>
<ul>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/51">#51</a>: ajoute des messages d&#8217;alerte informant sur la création de commandes</p>
</li>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/50">#50</a>: ajoute un bouton d&#8217;actualisation dans la page équipement</p>
</li>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/49">#49</a>: pas de demande de confirmation de sortie de page sur modifications de certains paramètres</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-05-11</div>
<ul>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/47">#47</a>: erreur "call to undefined function mb_check_encoding"</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-05-10</div>
<ul>
<li>
<p>Intégration des évolutions des 2 versions beta précédentes</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-05-10 (beta)</div>
<ul>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/46">#46</a>: mauvaise payload avec caractères non ASCII corrompt la commande information associée</p>
</li>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/44">#44</a>: amélioration de l&#8217;affichage dans le panneau de commandes</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-05-08 (beta)</div>
<ul>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/42">#42</a>: log erroné sur création d&#8217;une commande info</p>
</li>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/41">#41</a>: retour de jMQTT dans la catégorie protocole domotique (au lieu de passerelle domotique).</p>
</li>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/43">#43</a>: logguer qu&#8217;un équipement ou une commande est supprimé.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-04-29</div>
<ul>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/40">#40</a>: ajout du champ "valeur de la commande par defaut" (voir <a href="https://www.jeedom.com/forum/viewtopic.php?f=96&amp;t=32675&amp;p=612364#p602740">post de vincnet68 sur le forum</a>).</p>
</li>
<li>
<p>MAJ icone et fichier info.json suite évolution processus de publication sur le market (mail <a href="mailto:partenaire@jeedom.com">partenaire@jeedom.com</a> du 16/04/2018).</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-02-15</div>
<ul>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/36">#36</a>: le mode inclusion automatique d&#8217;équipements s&#8217;active maintenant via un bouton d&#8217;inclusion depuis la page du plugin et se désactive automatiquement après 2 à 3 min.</p>
</li>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/37">#37</a>: la bordure mettant en évidence un équipement dont l&#8217;ajout automatique de commandes est actif, est correctement affichée quelque soit le thème.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-02-06</div>
<ul>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/26">#26</a>: ajout d&#8217;une case à cocher dans l&#8217;équipement permettant de désactiver la création automatique des commandes de type information.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-02-05</div>
<ul>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/30">#30</a>: les commandes action n&#8217;étaient pas envoyées immédiatement depuis des scénarios.</p>
</li>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/25">#25</a>: les commandes avec Qos=2 n&#8217;étaient pas envoyées.</p>
</li>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/28">#28</a>: rend possible la définition de commandes action JSON (voir exemples dans la documentation: <a href="#_commandes_de_type_action">Commandes de type Action</a>).</p>
</li>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/31">#31</a>: message de log erroné sur accusé de réception de souscription.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-01-26</div>
<ul>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/23">#23</a>: sur une rafale de commande, seule la dernière était envoyée.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-01-24</div>
<ul>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/19">#19</a>: ajoute une option pour ne pas installer Mosquitto localement.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-01-15</div>
<ul>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/10">#10</a>: duplication d&#8217;équipement (voir la doc).</p>
</li>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/15">#15</a>: les topics commençant par / n&#8217;étaient pas souscrits après désactivation du mode manuel</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Si vous avez des topics commençant par / créés avant cette version, il faut ajouter le / en début de topic souscrit dans les équipements concernés. Les commandes de types info vont être recréer par le plugin, il faudra supprimer les anciennes (celles dont le topic ne commencent pas par /). En cas de doutes, de questions, n&#8217;hésiter pas à poster sur le forum.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/13">#13</a>: commande null systématiquement envoyée sur création d&#8217;une commande action.</p>
</li>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/14">#14</a>: le champ de sélection value, sous le nom d&#8217;une commande de type action, est supprimé car il n&#8217;avait pas d&#8217;effet.</p>
</li>
<li>
<p>Amélioration <a href="https://github.com/domotruc/jMQTT/issues/17">#17</a>: autorise les équipements avec topic vide.</p>
</li>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/18">#18</a>: arrête de créer une commande info relative à une commande action.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-01-08</div>
<ul>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/9">#9</a>: l&#8217;installation se bloque à 80% au redémarrage du serveur apache.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-01-06</div>
<ul>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/7">#7</a>: erreur "Le nom de l&#8217;équipement ne peut pas être vide" et arrêt du démon sur réception d&#8217;un topic commençant par /.</p>
</li>
<li>
<p>Amélioration de l&#8217;installation: ajout du statut de progression, lisibilité fichier de log</p>
</li>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/1">#1</a>: dernière valeur maintenue retain au niveau du broker sur suppression du mode retain d&#8217;une commande.</p>
</li>
<li>
<p>Correction <a href="https://github.com/domotruc/jMQTT/issues/6">#6</a>: case inversion cochée par défaut pour information binaire.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-01-04</div>
<ul>
<li>
<p>MAJ du README côté GitHub</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-01-03</div>
<ul>
<li>
<p>MAJ de la documentation</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2018-01-01</div>
<ul>
<li>
<p>Supprime les tentatives de reconnexion toutes les secondes sur problème de connexion au broker: rend maintenant la main au core Jeedom qui relancera le démon (et donc la reconnexion) toutes les 5min.</p>
</li>
<li>
<p>Correction bug sur authentification auprès du broker (merci Nicolas)</p>
</li>
<li>
<p>Message d&#8217;erreur sur définition d&#8217;un topic vide</p>
</li>
<li>
<p>MAJ fichier internationalisation</p>
</li>
<li>
<p>Changement de la couleur de l&#8217;icône et des images du plugin (jaune au lieu de bleu)</p>
</li>
<li>
<p>MAJ liens de la doc</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">2017-12-26</div>
<ul>
<li>
<p>Version initiale</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-06-07 22:55:06 CEST
</div>
</div>
</body>
</html>